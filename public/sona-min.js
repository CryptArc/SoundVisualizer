"use strict";var SOUNDCLOUD_CLIENT_ID="802c2f1c80c96881ff265799929e8a2c",dom=function(){function e(t,i){o(!n(t),"You should input the string"),t.indexOf("%c")>-1?(i=i||e.styles,console.log(t,i)):console.log(t)}function t(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function n(e){return"string"===t(e)}function i(e){return!!e&&1===e.nodeType}function r(e){return 9===e.nodeType}function o(e,t){if(e)throw new Error(t)}function a(e,t){return o(!n(e),"arguments must be string type"),t=(n(t)?u(t):t)||document,o(!i(t)&&!r(t),"Second Element must be element node"),t.querySelectorAll(e)}function u(e,t){return a(e,t)[0]}function c(e,t){o(!n(t),"arguments must be string type");var i=e.className.split(" ");return i.indexOf(t)!==-1}function s(e,t){o(!n(t),"arguments must be string type"),c(e,t)||(e.className=e.className+" "+t)}function l(e,t){c(e,t)?e.className=e.className.split(" ")[0]:s(e,t)}function d(e){e=(n(e)?u(e):e)||document,e.style.display="block"}function q(e){e=(n(e)?u(e):e)||document,e.style.display="none"}function h(e){var t=/https:\/\/soundcloud.com\/[0-9a-z-]+\/[0-9a-z-]+/;return t.test(e)}var f="1.0.0",p="sona";return e.styles="color: #fe4940; font-size: 1.2rem;",{info:{version:f,author:p},util:{cLog:e,toggle:l,isCorrectSoundCloudURL:h},query:u,show:d,hide:q}}(),sona=function(){function e(){s.clearRect(0,0,c.width,c.height),s.beginPath(),s.rect(0,0,c.width,c.height);var e=Math.floor(2*Math.random()),t=s.createLinearGradient(0,0,1500,0);t.addColorStop(0,g[e][0]),t.addColorStop(1,g[e][1]),s.fillStyle=t,s.fill()}function t(){a&&(a.width=window.innerWidth,a.height=window.innerHeight,c.width=window.innerWidth,c.height=window.innerHeight,e())}function n(){var e,t,i=0,r=d.frequencyBinCount,o=new Uint8Array(r),c=a.width/r*2.5;d.getByteFrequencyData(o),u.clearRect(-a.width,-a.height,2*a.width,2*a.height);for(var s=0,l=r;s<l;s++)t=o[s],e=3*t,u.fillStyle="rgba("+(t+200)+", "+(t+200)+","+(t+200)+", 0.4)",u.fillRect(i,a.height-e/2+100,c,e/100),u.fillRect(i,a.height-e/2,c,e/2),u.beginPath(),u.arc(i,a.height-e/2-90,c/3,0,2*Math.PI,!1),u.fill(),i+=c+1;requestAnimationFrame(n)}function i(e){l.setAttribute("src",e)}function r(){clearInterval(h)}function o(i){d=i.analyser,q=i.canvas,a=document.createElement("canvas"),a.setAttribute("style","position: absolute; z-index: 10"),u=a.getContext("2d"),q.appendChild(a),l=document.createElement("img"),l.setAttribute("style","position: absolute; z-index: 20; top: 10px; right: 10px; opacity: 0.5"),q.appendChild(l),c=document.createElement("canvas"),s=c.getContext("2d"),q.appendChild(c),t(),n(),h=setInterval(e,500),window.addEventListener("resize",t,!1)}var a,u,c,s,l,d,q,h,f="1.0.0",p="sona",g={0:["#32e2e4","#fc4cff"],1:["#00DBDE","#FC00FF"]};return{info:{version:f,author:p},init:o,drawAlbumImg:i,clearBackEffect:r}}(),sound=function(e){function t(i){return this instanceof t?void this._init.apply(this,arguments):(e.initialize({client_id:n}),new t(i))}var n=SOUNDCLOUD_CLIENT_ID;return t.fn=t.prototype={constructor:t,author:"sona",version:"1.0.0",_init:function(e){var t=new(window.AudioContext||window.webkitAudioContext),n=t.createMediaElementSource(e);this.audio=e,this.analyser=t.createAnalyser(),this.analyser.fftSize=256,this.analyser.connect(t.destination),this.audio.crossOrigin="anonymous",n.connect(this.analyser)},search:function(t,i,r){e.resolve(t).then(function(e){if(e.stream_url){var t=e.stream_url+"?client_id="+n,o=e.artwork_url;i.call(this,t,o)}else r("Playlist is not supported")}).catch(function(e){r(e)})},play:function(e){this.audio.src="data:audio/mpeg;base64,/+MYxAAAAANIAUAAAASEEB/jwOFM/0MM/90b/+RhST//w4NFwOjf///PZu////9lns5GFDv//l9GlUIEEIAAAgIg8Ir/JGq3/+MYxDsLIj5QMYcoAP0dv9HIjUcH//yYSg+CIbkGP//8w0bLVjUP///3Z0x5QCAv/yLjwtGKTEFNRTMuOTeqqqqqqqqqqqqq/+MYxEkNmdJkUYc4AKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq",this.audio.setAttribute("src",e),this.audio.play()}},t}(SC);!function(e,t,n){function i(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),n=t.exec(location.search);return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))}function r(t){g.search(t,function(t,i){e.show(l),p.toggle(q,"warnPanel--hidden"),g.play(t),n.drawAlbumImg(i),setTimeout(p.toggle(h,"ctrgroup--hidden"),3e3)},function(t){403===t.status?e.query(".warnPanel__p").innerHTML="This song is not supported":e.query(".warnPanel__p").innerHTML=t,e.show(q)})}var o=!!document.documentMode;o&&(e.query(".layer").style.display="table");var a="track",u=e.query(".ctrgroup__player__form"),c=e.query(".ctrgroup__togglebtn"),s=e.query(".ctrgroup__player__form__input"),l=e.query(".visualPanel"),d=e.query(".defaultPanel"),q=e.query(".warnPanel"),h=e.query(".ctrgroup"),f=e.query(".ctrgroup__player__audio"),p=e.util,g=t(f);if(n.init({analyser:g.analyser,canvas:l}),p.toggle(h,"ctrgroup--hidden"),e.hide(l),i(a)){var y=i(a);s.value=y,r(y)}u.addEventListener("submit",function(t){t.preventDefault(),e.hide(d),console.log("##############33",p.isCorrectSoundCloudURL(s.value)),p.isCorrectSoundCloudURL(s.value)?r(s.value):(e.query(".warnPanel__p").innerHTML="invalid soundcloud url",e.show(q))}),c.addEventListener("click",function(e){e.preventDefault(),p.toggle(h,"ctrgroup--hidden")}),f.addEventListener("ended",function(){e.show(l),n.clearBackEffect()}),window.addEventListener("keydown",function(e){32===e.which&&(f.paused?f.play():f.pause())})}(dom,sound,sona);